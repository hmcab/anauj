
#lang racket
		(require web-server/servlet
				web-server/servlet-env
				web-server/dispatch)
		(require (planet neil/html-writing:2:0))
		(provide/contract (start (request? . -> . response?)))
		(require 2htdp/batch-io)

(require "empven-crud.rkt")
(require "empven-view.rkt")

(define (start request) 
	(empven-dispatch request))

(define-values (empven-dispatch empven-url)
	(dispatch-rules
		[("ventas") empven-ventas-tmp]
		[("") empven-index-tmp]))

(define (empven-ventas-tmp request)
	(empven-ventas null request))

(define (empven-index-tmp request)
	(empven-ventas null request))


(define (empven-ventas args request) (local ((define (response-generator embed/url) (response/xexpr (quasiquote (html (head (title "empven-ventas") (style ((type "text/css")) "\n/* Edit your css file. */\n\nbody {\n    /* width: 100%; */\n    width: 1280px;\n    max-width: 100%;\n    font-family: verdana,sans-serif;\n    font-size: 11px;\n    font-variant: normal;\n    text-align: left;\n}\n\nform {\n    padding-top: 30px;\n    padding-left: 20px;\n    display: inline-block;\n}\n\n#div-menu {\n    width: 80%;\n}\n\n#div-menu ul {\n    margin: 0;\n    padding: 0;\n    list-style-type: none;\n    text-align: center;\n}\n#div-menu ul li {\n    display: inline;\n}\n#div-menu ul li a {\n    text-decoration: none;\n    /*padding-left: 5px;\n    padding-right: 5px;*/\n    padding: .2em 1em;\n    color: #fff;\n    background-color: #036;\n}\n#div-menu ul li a:hover {\n    color: #fff;\n    background-color: #369;\n}\n\n#div-form-buttons {\n    float: left;\n    width: 80%;\n    padding-left: 80px;\n}\n\n#msgrest-container {\n    float: left;\n    width: 80%;\n    height: 40px;\n}\n\n#msgrest {\n    float: left;\n    width: 512px;\n    height: 20px;\n    margin-top: 5px;\n    margin-left: 20px;\n    padding-top: 5px;\n    padding-left: 10px;\n    border: 1px solid #d8000c;\n    background-color: #ffbaba;\n    color: #d8000c;\n}\n\n#form-real {\n    padding-top: 15px;\n    padding-left: 20px;\n    float: left;\n    width: 80%;\n}\n#form-real div {\n    float: left;\n    height: 24px;\n    width: 432px;\n    padding-bottom: 3px;\n}\n#form-real span.titulo {\n    /*float: left;\n    width: 25px;*/\n    float: left;\n    width: 72px;\n    display: inline-block;\n    \n}\n#form-real div.date {\n    float: left;\n    width: 80%;\n}\n#form-real input {\n    border: 1px solid rgb(0,0,102);\n}\n\n/*\n#div-table-form {\n    float: left;\n    width: 80%;\n    padding-top: 30px;\n    padding-left: 20px;\n    font-variant: normal;\n}\n#div-table-form table {\n    background-color: #f9f9f9;\n    border: 1px solid #aaa;\n    border-collapse: collapse;\n    font-family: verdana, sans-serif;\n    font-size: 13px;\n    width: 1024;\n}\n#div-table-form table tr {\n    border: 1px solid #aaa;\n}\n#div-table-form table td {\n    border-left: 1px solid #aaa;\n    padding-right: 14px;\n}\n*/\n\n#div-table-response {\n    float: left;\n    width: 80%;\n    padding-top: 15px;\n    padding-left: 20px;\n    font-variant: normal;\n}\n#div-tableselect-all {\n    float: left;\n    width: 80%;\n    padding-top: 15px;\n    padding-left: 20px;\n    font-variant: normal;\n}\n#div-tableselect-all table, #div-table-response table {\n    background-color: #f9f9f9;\n    border: 1px solid #aaa;\n    border-collapse: collapse;\n    font-family: verdana, sans-serif;\n    font-size: 13px;\n    width: 1024;\n}\n#div-tableselect-all table tr, #div-table-response table tr {\n    border: 1px solid #aaa;\n}\n#div-tableselect-all table td, #div-table-response table td {\n    border-left: 1px solid #aaa;\n    padding-right: 14px;\n}\n\n#message {\n    float: left;\n    width: 80%;\n    padding-top: 10px;\n    padding-left: 20px;\n}\n#message span {\n    color: red;\n}\n\ntextarea {\n    min-height: 20px;\n    max-height: 20px;\n}\n") (script ((type "text/javascript") (src "/app.js")) " ")) (body ((onload "init();")) (div ((id "div-menu") (name "div-menu")) (ul (li (a ((href "/ventas")) "ventas")))) (div ((id "div-form-buttons") (name "div-form-buttons")) (form ((id "form-insert-venta") (class "insert-form") (method "post") (action (unquote (embed/url insert-venta)))) (input ((type "hidden") (name "totalventa_crud") (id "totalventa_crud"))) (input ((type "hidden") (name "fecventa_crud") (id "fecventa_crud"))) (input ((type "hidden") (name "numdoc_crud") (id "numdoc_crud"))) (input ((type "hidden") (name "id_crud") (id "id_crud"))) (input ((type "button") (value "insert-venta") (onclick "process_crud_form('form-insert-venta');")))) (form ((id "form-update-totalventa") (class "update-form") (method "post") (action (unquote (embed/url update-totalventa)))) (input ((type "hidden") (name "totalventa_crud") (id "totalventa_crud"))) (input ((type "hidden") (name "id_crud") (id "id_crud"))) (input ((type "button") (value "update-totalventa") (onclick "process_crud_form('form-update-totalventa');"))))) (div ((id "msgrest-container")) (div ((id "msgrest") (name "msgrest")) " ")) (form ((id "form-real")) (div ((class "numerico")) (span ((class "titulo")) "total venta") (input ((type "text") (name "totalventa") (id "totalventa") (size "10") (maxlength "10") (onblur "checkRestrictions(this);")))) (div ((class "alfanumerico")) (span ((class "titulo")) "fecha venta") (div ((class "date") (name "fecventa") (id "fecventa")) (select ((id "select_day")) (option ((value "1")) "1") (option ((value "2")) "2") (option ((value "3")) "3") (option ((value "4")) "4") (option ((value "5")) "5") (option ((value "6")) "6") (option ((value "7")) "7") (option ((value "8")) "8") (option ((value "9")) "9") (option ((value "10")) "10") (option ((value "11")) "11") (option ((value "12")) "12") (option ((value "13")) "13") (option ((value "14")) "14") (option ((value "15")) "15") (option ((value "16")) "16") (option ((value "17")) "17") (option ((value "18")) "18") (option ((value "19")) "19") (option ((value "20")) "20") (option ((value "21")) "21") (option ((value "22")) "22") (option ((value "23")) "23") (option ((value "24")) "24") (option ((value "25")) "25") (option ((value "26")) "26") (option ((value "27")) "27") (option ((value "28")) "28") (option ((value "29")) "29") (option ((value "30")) "30") (option ((value "31")) "31")) (select ((id "select_month")) (option ((value "1")) "Enero") (option ((value "2")) "Febrero") (option ((value "3")) "Marzo") (option ((value "4")) "Abril") (option ((value "5")) "Mayo") (option ((value "6")) "Junio") (option ((value "7")) "Julio") (option ((value "8")) "Agosto") (option ((value "9")) "Septiembre") (option ((value "10")) "Octubre") (option ((value "11")) "Noviembre") (option ((value "12")) "Diciembre")) (select ((id "select_year")) (option ((value "1910")) "1910") (option ((value "1911")) "1911") (option ((value "1912")) "1912") (option ((value "1913")) "1913") (option ((value "1914")) "1914") (option ((value "1915")) "1915") (option ((value "1916")) "1916") (option ((value "1917")) "1917") (option ((value "1918")) "1918") (option ((value "1919")) "1919") (option ((value "1920")) "1920") (option ((value "1921")) "1921") (option ((value "1922")) "1922") (option ((value "1923")) "1923") (option ((value "1924")) "1924") (option ((value "1925")) "1925") (option ((value "1926")) "1926") (option ((value "1927")) "1927") (option ((value "1928")) "1928") (option ((value "1929")) "1929") (option ((value "1930")) "1930") (option ((value "1931")) "1931") (option ((value "1932")) "1932") (option ((value "1933")) "1933") (option ((value "1934")) "1934") (option ((value "1935")) "1935") (option ((value "1936")) "1936") (option ((value "1937")) "1937") (option ((value "1938")) "1938") (option ((value "1939")) "1939") (option ((value "1940")) "1940") (option ((value "1941")) "1941") (option ((value "1942")) "1942") (option ((value "1943")) "1943") (option ((value "1944")) "1944") (option ((value "1945")) "1945") (option ((value "1946")) "1946") (option ((value "1947")) "1947") (option ((value "1948")) "1948") (option ((value "1949")) "1949") (option ((value "1950")) "1950") (option ((value "1951")) "1951") (option ((value "1952")) "1952") (option ((value "1953")) "1953") (option ((value "1954")) "1954") (option ((value "1955")) "1955") (option ((value "1956")) "1956") (option ((value "1957")) "1957") (option ((value "1958")) "1958") (option ((value "1959")) "1959") (option ((value "1960")) "1960") (option ((value "1961")) "1961") (option ((value "1962")) "1962") (option ((value "1963")) "1963") (option ((value "1964")) "1964") (option ((value "1965")) "1965") (option ((value "1966")) "1966") (option ((value "1967")) "1967") (option ((value "1968")) "1968") (option ((value "1969")) "1969") (option ((value "1970")) "1970") (option ((value "1971")) "1971") (option ((value "1972")) "1972") (option ((value "1973")) "1973") (option ((value "1974")) "1974") (option ((value "1975")) "1975") (option ((value "1976")) "1976") (option ((value "1977")) "1977") (option ((value "1978")) "1978") (option ((value "1979")) "1979") (option ((value "1980")) "1980") (option ((value "1981")) "1981") (option ((value "1982")) "1982") (option ((value "1983")) "1983") (option ((value "1984")) "1984") (option ((value "1985")) "1985") (option ((value "1986")) "1986") (option ((value "1987")) "1987") (option ((value "1988")) "1988") (option ((value "1989")) "1989") (option ((value "1990")) "1990") (option ((value "1991")) "1991") (option ((value "1992")) "1992") (option ((value "1993")) "1993") (option ((value "1994")) "1994") (option ((value "1995")) "1995") (option ((value "1996")) "1996") (option ((value "1997")) "1997") (option ((value "1998")) "1998") (option ((value "1999")) "1999") (option ((value "2000")) "2000") (option ((value "2001")) "2001") (option ((value "2002")) "2002") (option ((value "2003")) "2003") (option ((value "2004")) "2004") (option ((value "2005")) "2005") (option ((value "2006")) "2006") (option ((value "2007")) "2007") (option ((value "2008")) "2008") (option ((value "2009")) "2009") (option ((value "2010")) "2010") (option ((value "2011")) "2011") (option ((value "2012")) "2012") (option ((value "2013")) "2013") (option ((value "2014")) "2014") (option ((value "2015")) "2015")))) (div ((class "numerico")) (span ((class "titulo")) "numero documento") (input ((type "text") (name "numdoc") (id "numdoc") (size "10") (maxlength "10") (onblur "checkRestrictions(this);")))) ()) (unquote (if (string? args) (quasiquote (div ((id "message")) (span "* ") (unquote args))) (if (list? args) (render-table "div-table-response" args) ""))) (unquote (render-table "div-tableselect-all" (bd-select-all-ventas)))))))) (define (insert-venta request) (define bind (request-bindings request)) (define totalventa (extract-binding/single (quote totalventa_crud) bind)) (define fecventa (extract-binding/single (quote fecventa_crud) bind)) (define numdoc (extract-binding/single (quote numdoc_crud) bind)) (define id (extract-binding/single (quote id_crud) bind)) (define nargs (bd-insert-venta totalventa fecventa numdoc id)) (empven-ventas nargs request)) (define (update-totalventa request) (define bind (request-bindings request)) (define totalventa (extract-binding/single (quote totalventa_crud) bind)) (define id (extract-binding/single (quote id_crud) bind)) (define nargs (bd-update-totalventa totalventa id)) (empven-ventas nargs request))) (send/suspend/dispatch response-generator)))

(define path (build-path "/home/hmc/Documentos/racket-proy/codegen-arq/generacion-datos/apps/empven"))
(serve/servlet start
		#:launch-browser? #f
		#:quit? #t
		#:listen-ip #f
		#:port 8900
		#:server-root-path path
		#:extra-files-paths (list (build-path "/home/hmc/Documentos/racket-proy/codegen-arq/generacion-datos/apps/empven" "htdocs"))
		#:servlet-path "/ventas"
		#:servlet-regexp #rx""
		#:file-not-found-responder empven-ventas-tmp)
